<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
	    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable=0">
		<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Expires" content="0">

		<title>Takepoints.io</title>
		<meta content="Takepoints.io" property="og:title"/>
		<meta content="https://stats.takepoints.io/img/thumbnail.png" property="og:image"/>
		<meta content="#ed5555" name="theme-color"/>
		<meta name="description" content="Takepoints.io is a tactical, objective-based shooter. Capture and defend points from other teams, unlock weapons, upgrades and perks. Player stats can be viewed at stats.takepoints.io."/>
		<meta name="twitter:card" content="summary_large_image">

		<link rel="stylesheet" type="text/css" href="style.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="" crossorigin="anonymous">
		<!--link rel="icon" type="image/png" href="img/favicon-16x16.png" sizes="16x16">
		<link rel="icon" type="image/png" href="img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="img/favicon-96x96.png" sizes="96x96"-->

		<link href="https://fonts.googleapis.com/css?family=Orbitron:900" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-WW8M32ERSM"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'G-WW8M32ERSM');
		</script>
	</head>
	<body oncontextmenu="return false;">
		<span id="loading" class="loading-connecting">Loading...</span>
		<span id="connecting" class="loading-connecting">Connecting...</span>
		<div id="reconnectButtonContainer" style="display:none;">
			<span id="disconnected" class="loading-connecting">Disconnected</span>
			<button id="reconnectButton" onclick="window.location.reload();">Reconnect</button>
		</div>

		<canvas id="canvas"></canvas>
		<canvas id="hud"></canvas>

		<div id="chatboxContainer">
			<div id="slashCommandContainer"></div>
			<input id="chatbox" autocomplete="off" placeholder="Type a message" maxlength="32" length="32" style="display:none;">
		</div>

		<div class="game-menu-container" id="enterGameContainer">
			<!--img id="logo" src="/img/logo.png"-->
			<img id="logo" src="/img/logo-new.svg" alt="Game logo"/>

			<h2 id="gameFact"></h2>

			<div class="menu-container">
				<div class="menu-segment" id="a-left">
					<iframe class="featured-yt" width="100%" height="100%" src="https://www.youtube.com/embed/xOD8Fz1TFK0?si=0b02Nf3HBqW6PXe3&amp;start=24&amp;enablejsapi=1" title="YouTube video player" frameborder="0" allowfullscreen></iframe>
				</div>
				<div class="menu-middle">
					<div class="menu-segment enter-game-container">
						<button type="button" class="play-button" id="p" onclick="eg()">Play</button>
						<div class="auth-button-row">
							<button type="button" class="authBtn" id="loginBtn" style="display:none;">Login</button>
							<button type="button" class="authBtn" id="registerBtn" style="display:none;">Register</button>
							<button type="button" class="authBtn center" id="logoutBtn" style="display:none;" onclick="logout()">Logout</button>
						</div>
						<div class="enter-game-row">
							<h3 id="authLabel">Not Logged In</h3>
						</div>
					</div>
					<div class="menu-segment server-selection">
						<div id="server-flex-row">
							<h1 class="menu-title-big">Servers</h1>
							<button type="button" class="sharelink" onclick="cs()" title="Copy server link">
								<i class="fa fa-link" aria-hidden="true"></i>
							</button>
						</div>
						<div class="server-selector-container">
							<select id="serverSelector" class="server-selector" onchange="switchServer(this.value)"></select>
						</div>
					</div>
				</div>
				<div class="menu-segment info-scroller">
					<h2 class="menu-title-big align-center">Changelog</h2>

					<h2 class="menu-title-medium align-left">August 13, 2024</h2>
					<p class="changelog-text">
						- Added some new guest names <br>
						- Throwable items now stop properly when they reach the edge of the map <br>
						- Deployed a hotfix for servers sometimes not letting players join <br>
						- Takepoints.io is now out of closed beta! Testers have been given a special badge on their <a href="https://stats.takepoints.io/"">Player Summary</a>.
					</p>

					<h2 class="menu-title-medium align-left">July 14, 2024</h2>
					<p class="changelog-text">
						- Added weapon attachments. See the full list on the stats page. <br>
						- Weapon attachments unlock at level 20, once you've selected a tier 2 weapon.
					</p>

					<h2 class="menu-title-medium align-left">June 26, 2024</h2>
					<p class="changelog-text">
						- Gas grenades now only deal damage to enemy teams <br>
						- Buffed the radius and damage of the gas grenade by 50% each
					</p>

					<h2 class="menu-title-medium align-left">June 22, 2024</h2>
					<p class="changelog-text">
						- Implemented daily highscore tracking <br>
						- Tweaked acceleration slightly <br>
						- Added a <a href="https://stats.takepoints.io/"">stats</a> page with leaderboards and player statistics <br>
						- The left container is now a Featured Youtuber section
					</p>

					<h2 class="menu-title-medium align-left">June 18, 2024</h2>
					<p class="changelog-text">
						- Redesigned the UI <br>
						- Fixed a bug causing dropped inputs <br>
						- All perks are now available. Unlock them at level 15 and press space to activate them.
					</p>

				</div>
			</div>

			<div class="menu-segment wide-ad-unit" id="a-bottom">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2167384480353654" crossorigin="anonymous"></script>
				<!-- ad1 -->
				<ins 
					class="adsbygoogle"
					style="display:inline-block;width:970px;height:250px"
					data-ad-client="ca-pub-2167384480353654"
					data-ad-slot="8203420191"
				></ins>
				<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
				</script>
			</div>

			<div id="footers">
				<div id="infoFooter">
					<a id="moreGamesLink" target="_blank" href="https://iogames.space">More Games</a> | 
					<a target="_blank" href="https://stats.takepoints.io">Stats</a> | 
					<a target="_blank" href="https://stats.takepoints.io/changelog">Changelog</a>
				</div>
				<div id="socialFooter">
					<a id="discordButton" target="_blank" href="https://discord.gg/vbZqzuv">Discord</a>
				</div>
			</div>
		</div>

		<div id="highscores">
			<h1 id="hiscoresHeading">Top Scores Today</h1>
			<ul id="highScoresList"></ul>
		</div>

		<div id="loginModal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<span id="loginClose" class="close">&times;</span>
					<h2>Login</h2>
				</div>
				<div class="modal-body">
					<div class="input-group">
						<label for="usernameOrEmail"><b>Username or Email</b></label>
						<input type="text" name="usernameOrEmail" id="loginUsernameOrEmail" class="input" required>
					</div>
					<div class="input-group">
						<label for="password"><b>Password</b></label>
						<input type="password" name="password" id="loginPassword" class="input" required>
					</div>
					<label>
						<input type="checkbox" checked="checked" name="remember" id="rememberMe"> Remember me
					</label>

					<div class="input-group">
						<div class="errorMessage" id="loginError" style="display:none;"></div>
					</div>
					<p>Don't have an account? <a class="link" href="#" onclick="openRegister()">Register</a></p>
					<p>Forgot your password? <a class="link" href="https://stats.takepoints.io/password/reset">Click here</a></p>
					<button class="modal-btn" id="loginSubmitBtn" onclick="login()">Login</button>
				</div>
			</div>
		</div>

		<div id="registerModal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<span id="registerClose" class="close">&times;</span>
					<h2>Register</h2>
				</div>
				<div class="modal-body">
					<div class="input-group">
						<label for="username" class="label"><b>Username</b></label>
						<input type="text" name="username" id="registerUsername" class="input" maxlength=12 required>
						<div class="errorMessage" id="usernameError" style="display:none;"></div>
					</div>
					<div class="input-group">
						<label for="email" class="label"><b>Email</b></label>
						<input type="text" name="email" id="registerEmail" class="input" required>
						<div class="errorMessage" id="emailError" style="display:none;"></div>
					</div>
					<div class="input-group">
						<label for="password" class="label"><b>Password</b></label>
						<input type="password" name="password" id="registerPassword" class="input" required>
						<div class="errorMessage" id="passwordError" style="display:none;"></div>
					</div>
					<p>Already have an account? <a class="link" href="#" onclick="openLogin()">Log In</a></p>
					<button class="modal-btn" id="registerSubmitBtn" onclick="register()">Register</button>
				</div>
			</div>
		</div>

		<script src="https://www.google.com/recaptcha/api.js?render=6LcsTAEqAAAAAB3NYunGHbpXrZkKIgbj6oWuaqBy"></script>
		<script>
			const globalAPIBase = getBase();
			
			function getBase() {
				if (window.location.href.indexOf("https://takepoints.io") == 0) {
					return "https://api.takepoints.io";
				} 
				else if (window.location.href.indexOf("https://takepoint.nitrogem35.pw") == 0) {
					return "https://api.nitrogem35.pw";
				}
				else {
					let parts = window.location.href.split(":");
					let ending = parts.pop().split("/")[0];
					ending = "8080";
					return parts.join(":") + ":" + ending;
				}
			}

			(function(window, document) {
				console.log("Loading game client...");
				createScript("features.js");
				var path = "client-1.13.6.7.js";
				if(window.WebAssembly){
					path = "client-1.13.6.7.wasm.js";
				}
				console.log("Game client set to: " + path);
				var mainClient = createScript(path);
				mainClient.onerror = function(e){
					console.log(e);
					console.error("Script error, reloading page...");
					window.location.reload(true);
				};
			})(window, document);

			function createScript(path) {
				var clientScript = document.createElement("script");
				clientScript.type = "text/javascript";
				clientScript.src = path;
				clientScript.async = true;
				document.body.appendChild(clientScript);
				return clientScript;
			}

			var loginModal = document.getElementById("loginModal"),
				registerModal = document.getElementById("registerModal"),
				loginOpen = !1,
				registerOpen = !1,
				loginBtn = document.getElementById("loginBtn"),
				registerBtn = document.getElementById("registerBtn"),
				logoutBtn = document.getElementById("logoutBtn"),
				loginClose = document.getElementById("loginClose"),
				registerClose = document.getElementById("registerClose");
			function openLogin() {
				registerOpen && closeRegister(), (loginModal.style.display = "block"), (loginModal.style.zIndex = "7"), (loginOpen = !0);
			}
			function closeLogin() {
				(loginModal.style.display = "none"), (loginOpen = !1);
			}
			function openRegister() {
				loginOpen && closeLogin(), (registerModal.style.display = "block"), (registerModal.style.zIndex = "7"), (registerOpen = !0);
			}
			function closeRegister() {
				(registerModal.style.display = "none"), (registerOpen = !1);
			}
			function login() {
				var e = document.getElementById("loginUsernameOrEmail").value,
					t = document.getElementById("loginPassword").value;
				if (((document.getElementById("loginError").style.display = "none"), vi(e) || vi(t)))
					return (document.getElementById("loginError").innerHTML = "Your username or password contains invalid characters!"), void (document.getElementById("loginError").style.display = "block");
				Module.loginUser(e, t, document.querySelector("#rememberMe").checked);
			}
			function loginViaCookie() {
				"" != gc("rc") && Module.loginUserViaCookie(gc("rc"));
			}
			function register() {
				var e = document.getElementById("registerUsername").value,
					t = document.getElementById("registerEmail").value,
					n = document.getElementById("registerPassword").value;
				return (
					(document.getElementById("usernameError").style.display = "none"),
					(document.getElementById("emailError").style.display = "none"),
					(document.getElementById("passwordError").style.display = "none"),
					vi(e)
						? ((document.getElementById("usernameError").innerHTML = "Your username contains invalid characters!"), void (document.getElementById("usernameError").style.display = "block"))
						: vi(t)
						? ((document.getElementById("emailError").innerHTML = "Your email contains invalid characters!"), void (document.getElementById("emailError").style.display = "block"))
						: vi(n)
						? ((document.getElementById("passwordError").innerHTML = "Your password contains invalid characters!"), void (document.getElementById("passwordError").style.display = "block"))
						: void Module.registerUser(e, t, n)
				);
			}
			function logout() {
				Module.logoutUser();
			}
			(loginBtn.onclick = function () {
				openLogin();
			}),
			(registerBtn.onclick = function () {
				openRegister();
			}),
			(logoutBtn.onclick = function () {
				logout();
			}),
			(loginClose.onclick = function () {
				closeLogin();
			}),
			(registerClose.onclick = function () {
				closeRegister();
			}),
			(window.onclick = function (e) {
				(e.target != loginModal && e.target != registerModal) || (closeLogin(), closeRegister());
			});

			function fillStateData(e) {
				let table = document.getElementById("highScoresList");
				table.innerHTML = '';
				for (let key in e) {
					if (e[key].username) {
						let player = e[key];
						let listItem = document.createElement("li");
						listItem.appendChild(document.createTextNode(player.username + ": " + player.score.toLocaleString()));
						table.appendChild(listItem);
					} 
					else {
						try {
							document.getElementById("gameFact").innerHTML = e[key].toLocaleString() + " " + key + " today!";
						} catch (e) {
							return;
						}
					}
				}
			}

			function ai(e) {
				var t = "";
				for (var n in e) String(e[n]).match(/^[\x00-\x7F]*$/) ? (t += e[n]) : (t += "_");
				return t;
			}

			function vi(e) {
				return /[^A-Za-z0-9@._-]/.test(e);
			}

			function gc(e) {
				for (var t = e + "=", n = document.cookie.split(";"), o = 0; o < n.length; o++) {
					for (var r = n[o]; " " == r.charAt(0); ) r = r.substring(1);
					if (0 == r.indexOf(t)) return r.substring(t.length, r.length);
				}
				return "";
			}

			function eg() {
				let yt = document.getElementsByClassName("featured-yt")[0];
				yt.contentWindow.postMessage('{"event":"command","func":"stopVideo","args":""}', '*');
				loginOpen || registerOpen || Module.enterGame();
			}

			function sm() {
				let chatMsg = document.getElementById("chatbox").value;
				if (chatMsg.trim().length) Module.chat(ai(document.getElementById("chatbox").value));
			}

			function cs() {
				let server = window.location.origin + "/?server=" + document.getElementById("serverSelector").value;
				navigator.clipboard.writeText(server);
			}
			
			function switchServer(e) {
				Module.switchServers(e);
			}
			
			var gameStateRequest = new XMLHttpRequest();

			gameStateRequest.onreadystatechange = function () {
				4 == this.readyState && 200 == this.status && fillStateData(JSON.parse(this.responseText));
			}
			gameStateRequest.open("GET", globalAPIBase + "/gameState", !0);
			gameStateRequest.send();

			try{
				if(window.location.hostname == "crazygames.com"){
					document.getElementById("moreGamesLink").href = "https://www.crazygames.com/c/io";
				}
			}
			catch(e){
				console.error(e);
			}
		</script>
	</body>
</html>